#pragma once

#include "common.h"

#define CRNG_STATE_SIZE     16
#define CHACHA20_KEY_SIZE   32
#define CHACHA20_BLOCK_SIZE 64

struct crng_state {
    u32 state[CRNG_STATE_SIZE];
};

void initialize_crng(struct crng_state *crng);
void extract_crng(struct crng_state *crng, __u8 out[CHACHA20_BLOCK_SIZE]);
ssize_t extract_crng_user(struct crng_state *crng, void *buf, struct extraction_type ex);